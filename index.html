<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dropdown Example</title>
    <style>
        /* Add your CSS styles here */
        .subb {
            margin-left: 2em; /* Adjust the value as needed */
            display: none; /* Hide the div by default */
        }
    </style>
</head>
<body>
    <header>
        <h1>IHA Rack System</h1>
    </header>

    <main>
        <label for="dropdown1">Node Device 1 Address:</label>
        <select id="dropdown1">
            <option value="none">None</option>
            <option value="0x20">0x20</option>
            <option value="0x21">0x21</option>
            <option value="0x22">0x22</option>
            <option value="0x23">0x23</option>  
            <option value="0x24">0x24</option>
            <option value="0x25">0x25</option>
            <option value="0x26">0x26</option>
            <option value="0x27">0x27</option>   
            <!-- Add more options for Node Device 1 as needed -->
        </select>
    </main>
    <div class="subb">
        <label for="type1">Node Device Type:</label>
        <select id="type1">
            <option value="16 GPIO Rack Card 1">16 GPIO Rack Card 1</option>
            <option value="16 GPIO Rack Card 2">16 GPIO Rack Card 2</option>
            <option value="16 GPIO Rack Card 3">16 GPIO Rack Card 3</option>
            <option value="16 GPIO Rack Card 4">16 GPIO Rack Card 4</option>
            <option value="Button Controller">Button Controller</option>
            <option value="8 Port Relay Board 1">8 Port Relay Board 1</option>
            <option value="8 Port Relay Board 2">8 Port Relay Board 2</option>
            <option value="8 Port Relay Board 3">8 Port Relay Board 3</option> 
            <option value="8 Port Relay Board 4">8 Port Relay Board 4</option>      
            <!-- Add more options for Node Device Type 1 as needed -->
        </select>
    </div>

    <button id="downloadButton">Download YAML File</button>

    <!-- Add your JavaScript code here if needed -->
    <script>
        const dropdown = document.getElementById('dropdown1');
        const typeDropdown = document.getElementById('type1');
        const subbDiv = document.querySelector('.subb');
        const downloadButton = document.getElementById('downloadButton');

        dropdown.addEventListener('change', function() {
            // Show/hide the subbDiv based on the selected value
            subbDiv.style.display = dropdown.value === 'none' ? 'none' : 'block';
        });

        downloadButton.addEventListener('click', function() {
            // Get the selected values
            const selectedOptionValue = dropdown.value;
            const selectedTypeValue = typeDropdown.value;

            // Create the YAML configuration string
            const yamlConfig = `mcp23017:\n  - id: 'mcp23017_hub_16_gpio_rack_card_1'\n    address: "${selectedOptionValue}"`;

            const additionalConfig = `

    substitutions:
    gpio_rack_card_1_device_1: "GPIO 1"
    gpio_rack_card_1_device_2: "GPIO 2"
    gpio_rack_card_1_device_3: "GPIO 3"
    gpio_rack_card_1_device_4: "GPIO 4"
    gpio_rack_card_1_device_5: "GPIO 5"
    gpio_rack_card_1_device_6: "GPIO 6"
    gpio_rack_card_1_device_7: "GPIO 7"
    gpio_rack_card_1_device_8: "GPIO 8"
    gpio_rack_card_1_device_9: "GPIO 9"
    gpio_rack_card_1_device_10: "GPIO 10"
    gpio_rack_card_1_device_11: "GPIO 11"
    gpio_rack_card_1_device_12: "GPIO 12"
    gpio_rack_card_1_device_13: "GPIO 13"
    gpio_rack_card_1_device_14: "GPIO 14"
    gpio_rack_card_1_device_15: "GPIO 15"
    gpio_rack_card_1_device_16: "GPIO 16"   
    button:
    - platform: template
        name: Reset All GPIO to NO (1-16)
        icon: "mdi:alert"
        on_press:
        - lambda: |-
                id(device_1_set_1_16) = 1;
                id(device_2_set_1_16) = 1;
                id(device_3_set_1_16) = 1;
                id(device_4_set_1_16) = 1;
                id(device_5_set_1_16) = 1;
                id(device_6_set_1_16) = 1;
                id(device_7_set_1_16) = 1;
                id(device_8_set_1_16) = 1;
                id(device_9_set_1_16) = 1;
                id(device_10_set_1_16) = 1;
                id(device_11_set_1_16) = 1;
                id(device_12_set_1_16) = 1;
                id(device_13_set_1_16) = 1;
                id(device_14_set_1_16) = 1;
                id(device_15_set_1_16) = 1;
                id(device_16_set_1_16) = 1;
    - platform: template
        name: GPIO State Set (NO\NC 1-16)
        icon: "mdi:set-merge"
        on_press:
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 1") {
                id(device_1_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 1") {
                id(device_1_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 2") {
                id(device_2_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 2") {
                id(device_2_set_1_16) = 2;
            }          
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 3") {
                id(device_3_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 3") {
                id(device_3_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 4") {
                id(device_4_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 4") {
                id(device_4_set_1_16) = 2;
            }  
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 5") {
                id(device_5_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 5") {
                id(device_5_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 6") {
                id(device_6_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 6") {
                id(device_6_set_1_16) = 2;
            }          
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 7") {
                id(device_7_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 7") {
                id(device_7_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 8") {
                id(device_8_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 8") {
                id(device_8_set_1_16) = 2;
            }  
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 9") {
                id(device_9_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 9") {
                id(device_9_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 10") {
                id(device_10_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 10") {
                id(device_10_set_1_16) = 2;
            }          
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 11") {
                id(device_11_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 11") {
                id(device_11_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 12") {
                id(device_12_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 12") {
                id(device_12_set_1_16) = 2;
            }  
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 13") {
                id(device_13_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 13") {
                id(device_13_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 14") {
                id(device_14_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 14") {
                id(device_14_set_1_16) = 2;
            }          
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 15") {
                id(device_15_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 15") {
                id(device_15_set_1_16) = 2;
            }
        - lambda: |-
            if (id(device_select).state == "NO" && id(select_gpio).state == "GPIO 16") {
                id(device_16_set_1_16) = 1;
            } 
        - lambda: |-
            if (id(device_select).state == "NC" && id(select_gpio).state == "GPIO 16") {
                id(device_16_set_1_16) = 2;
            }  
        - select.set:
            id: select_gpio
            option: "None" 

    select:
    - platform: template
        name: Select GPIO (1-16)
        id: select_gpio
        optimistic: true
        initial_option: "None"
        options:
        - "None"
        - "GPIO 1"
        - "GPIO 2"
        - "GPIO 3"
        - "GPIO 4"  
        - "GPIO 5"
        - "GPIO 6"
        - "GPIO 7"
        - "GPIO 8"  
        - "GPIO 9"
        - "GPIO 10"
        - "GPIO 11"
        - "GPIO 12"  
        - "GPIO 13"
        - "GPIO 14"
        - "GPIO 15"
        - "GPIO 16"     

    - platform: template
        name: GPIO NO\NC (1-16)
        id: device_select
        optimistic: true
        initial_option: "NO"
        options:
        - "NO"
        - "NC"

    globals:
    - id: device_1_set_1_16
        type: float
        restore_value: yes
    - id: device_2_set_1_16
        type: float
        restore_value: yes
    - id: device_3_set_1_16
        type: float
        restore_value: yes
    - id: device_4_set_1_16
        type: float
        restore_value: yes
    - id: device_5_set_1_16
        type: float
        restore_value: yes
    - id: device_6_set_1_16
        type: float
        restore_value: yes
    - id: device_7_set_1_16
        type: float
        restore_value: yes
    - id: device_8_set_1_16
        type: float
        restore_value: yes
    - id: device_9_set_1_16
        type: float
        restore_value: yes
    - id: device_10_set_1_16
        type: float
        restore_value: yes
    - id: device_11_set_1_16
        type: float
        restore_value: yes
    - id: device_12_set_1_16
        type: float
        restore_value: yes
    - id: device_13_set_1_16
        type: float
        restore_value: yes
    - id: device_14_set_1_16
        type: float
        restore_value: yes
    - id: device_15_set_1_16
        type: float
        restore_value: yes
    - id: device_16_set_1_16
        type: float
        restore_value: yes   





    binary_sensor:
    - platform: template
        name: $gpio_rack_card_1_device_1
        id: device_1_invert
        lambda: |-
        if ((id(rack_1_device).state == true && id(device_1_set_1_16) == 1) || 
            (id(rack_1_device).state == false && id(device_1_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_1");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:   
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_1");
                id(last_state_pressed).publish_state("OFF");  
    - platform: gpio
        id: rack_1_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 0
        mode:
            input: True
            pullup: True          
        inverted: True
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_2
        id: device_2_invert
        lambda: |-
        if ((id(rack_2_device).state == true && id(device_2_set_1_16) == 1) || 
            (id(rack_2_device).state == false && id(device_2_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }
        on_press:
        then:   
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_2");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:       
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_2");
                id(last_state_pressed).publish_state("OFF");          
    - platform: gpio
        id: rack_2_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 1
        mode:
            input: True
            pullup: True    
        inverted: True
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_3
        id: device_3_invert
        lambda: |-
        if ((id(rack_3_device).state == true && id(device_3_set_1_16) == 1) || 
            (id(rack_3_device).state == false && id(device_3_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }      
        on_press:
        then:    
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_3");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_3");
                id(last_state_pressed).publish_state("OFF");          

    - platform: gpio
        id: rack_3_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 2
        mode:
            input: True
            pullup: True           
        inverted: True
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_4
        id: device_4_invert
        lambda: |-
        if ((id(rack_4_device).state == true && id(device_4_set_1_16) == 1) || 
            (id(rack_4_device).state == false && id(device_4_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }   
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_4");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_4");
                id(last_state_pressed).publish_state("OFF");              
    - platform: gpio
        id: rack_4_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 3
        mode:
            input: True
            pullup: True         
        inverted: True   
                    
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_5
        id: device_5_invert
        lambda: |-
        if ((id(rack_5_device).state == true && id(device_5_set_1_16) == 1) || 
            (id(rack_5_device).state == false && id(device_5_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        } 
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_5");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("K$gpio_rack_card_1_device_5");
                id(last_state_pressed).publish_state("OFF");           
    - platform: gpio
        id: rack_5_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 4
        mode:
            input: True
            pullup: True   
        inverted: True
        
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_6
        id: device_6_invert
        lambda: |-
        if ((id(rack_6_device).state == true && id(device_6_set_1_16) == 1) || 
            (id(rack_6_device).state == false && id(device_6_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }  
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_6");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_6");
                id(last_state_pressed).publish_state("OFF");                 
    - platform: gpio
        id: rack_6_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 5
        mode:
            input: True
            pullup: True        
        inverted: True
            
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_7
        id: device_7_invert
        lambda: |-
        if ((id(rack_7_device).state == true && id(device_7_set_1_16) == 1) || 
            (id(rack_7_device).state == false && id(device_7_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }    
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_7");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_7");
                id(last_state_pressed).publish_state("OFF");             
    - platform: gpio
        id: rack_7_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 6
        mode:
            input: True
            pullup: True      
        inverted: True

    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_8
        id: device_8_invert
        lambda: |-
        if ((id(rack_8_device).state == true && id(device_8_set_1_16) == 1) || 
            (id(rack_8_device).state == false && id(device_8_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }    
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_8");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_8");
                id(last_state_pressed).publish_state("OFF");        
    - platform: gpio
        id: rack_8_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 7
        mode:
            input: True
            pullup: True           
        inverted: True
    
                
    - platform: template
        name: $gpio_rack_card_1_device_9
        id: device_9_invert
        lambda: |-
        if ((id(rack_9_device).state == true && id(device_9_set_1_16) == 1) || 
            (id(rack_9_device).state == false && id(device_9_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_9");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:   
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_9");
                id(last_state_pressed).publish_state("OFF");  
    - platform: gpio
        id: rack_9_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 8
        mode:
            input: True
            pullup: True          
        inverted: True

    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_10
        id: device_10_invert
        lambda: |-
        if ((id(rack_10_device).state == true && id(device_10_set_1_16) == 1) || 
            (id(rack_10_device).state == false && id(device_10_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }
        on_press:
        then:   
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_10");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:       
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_10");
                id(last_state_pressed).publish_state("OFF");    
        
    - platform: gpio
        id: rack_10_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 9
        mode:
            input: True
            pullup: True    
        inverted: True

    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_11
        id: device_11_invert
        lambda: |-
        if ((id(rack_11_device).state == true && id(device_11_set_1_16) == 1) || 
            (id(rack_11_device).state == false && id(device_11_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }    
        on_press:
        then:    
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_11");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_11");
                id(last_state_pressed).publish_state("OFF");           
    - platform: gpio
        id: rack_11_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 10
        mode:
            input: True
            pullup: True           
        inverted: True
        

    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_12
        id: device_12_invert
        lambda: |-
        if ((id(rack_12_device).state == true && id(device_12_set_1_16) == 1) || 
            (id(rack_12_device).state == false && id(device_12_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }  
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_12");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_12");
                id(last_state_pressed).publish_state("OFF");                
    - platform: gpio
        id: rack_12_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 11
        mode:
            input: True
            pullup: True         
        inverted: True   
                
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_13
        id: device_13_invert
        lambda: |-
        if ((id(rack_13_device).state == true && id(device_13_set_1_16) == 1) || 
            (id(rack_13_device).state == false && id(device_13_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }   
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_13");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("K$gpio_rack_card_1_device_13");
                id(last_state_pressed).publish_state("OFF");           
    - platform: gpio
        id: rack_13_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 12
        mode:
            input: True
            pullup: True   
        inverted: True
        
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_14
        id: device_14_invert
        lambda: |-
        if ((id(rack_6_device).state == true && id(device_6_set_1_16) == 1) || 
            (id(rack_6_device).state == false && id(device_6_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }      
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_14");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_14");
                id(last_state_pressed).publish_state("OFF");             
    - platform: gpio
        id: rack_14_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 13
        mode:
            input: True
            pullup: True        
        inverted: True
            
    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_15
        id: device_15_invert
        lambda: |-
        if ((id(rack_15_device).state == true && id(device_15_set_1_16) == 1) || 
            (id(rack_15_device).state == false && id(device_15_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }     
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_15");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_15");
                id(last_state_pressed).publish_state("OFF");            
    - platform: gpio
        id: rack_15_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 14
        mode:
            input: True
            pullup: True      
        inverted: True

    #########################################################################
    - platform: template
        name: $gpio_rack_card_1_device_16
        id: device_16_invert
        lambda: |-
        if ((id(rack_16_device).state == true && id(device_16_set_1_16) == 1) || 
            (id(rack_16_device).state == false && id(device_16_set_1_16) == 2))
        {
            return true;
        } else {
            return false;
        }    
        on_press:
        then: 
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_16");
                id(last_state_pressed).publish_state("ON");         
        on_release:
        then:  
            - delay: 500ms
            - lambda: |-
                id(last_name_pressed).publish_state("$gpio_rack_card_1_device_16");
                id(last_state_pressed).publish_state("OFF");          
    - platform: gpio
        id: rack_16_device
        pin:
        mcp23xxx: mcp23017_hub_16_gpio_rack_card_1
        number: 15
        mode:
            input: True
            pullup: True           
        inverted: True

    `;

            // Combine the two configurations
            const combinedConfig = `${yamlConfig}\n${additionalConfig}`;

            // Create a Blob and download link
            const blob = new Blob([combinedConfig], { type: 'text/plain' });
            const downloadLink = document.createElement('a');

            // Set attributes for the download link
            downloadLink.href = URL.createObjectURL(blob);
            downloadLink.download = 'rack_system_config.yaml';

            // Append the link to the body and simulate a click to trigger the download
            document.body.appendChild(downloadLink);
            downloadLink.click();

            // Remove the link from the body
            document.body.removeChild(downloadLink);
        });
    </script>

</body>
</html>
